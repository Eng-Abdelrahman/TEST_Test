@model _3aqarak.MVC.ViewModels.VillsAvailableViewModel
@{
    ViewBag.Title = "Index";
    var user = (_3aqarak.BLL.Dto.UserDto)Session["User"];
}

@section styles{
    <style>
        td.details-control {
            background: url('../../Assets/Img/details_open.png') no-repeat center center;
            cursor: pointer;
        }

        tr.shown td.details-control {
            background: url('../../Assets/Img/details_close.png') no-repeat center center;
        }
    </style>
}
<div class="card">
    @Html.AntiForgeryToken()
    <div class="card-header">
        <div class="card-header text-right">
            <nav aria-label="breadcrumb" role="navigation" style="direction :rtl">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="@Url.Action("index","Home")" style="color:#0098f0"> الصفحة الرئيسية </a></li>
                    <!-- <li class="breadcrumb-item"><a href="#">Library</a></li> -->
                    <li class="breadcrumb-item active" aria-current="page"> أستعراض جميع عروض الفيلات المتاحه  </li>
                </ol>
            </nav>
        </div>
    </div>
    <!--****************************************************************-->
    <!--***********************************End***************************************************-->
    <!--************************************Start New one *************************************************-->
    <div class="card">
        @*<div class="card-header">

                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="/">Home</a></li>
                        <li class="breadcrumb-item"><a href="/">Library</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Data</li>
                    </ol>
                </nav>

            </div>*@
        <div class="card-body">

            <div class="row">

                <div class="col">
                    <h4 class="text-right">المنطقة من</h4>
                    @Html.DropDownList("regionss", Model.Regions as SelectList, "All", new { @class = "form-control", }) <br />
                    <h4 class="text-right">المنطقة إلى</h4>
                    @Html.DropDownList("regionssTo", Model.Regions as SelectList, "All", new { @class = "form-control", })
                </div>


                <!-- End of column -->
                <div class="col">
                    <div class="form-group">
                        <label class="preLabel" for="spaceFrom">المساحة من  :</label>
                        <input type="number" class="form-control" id="spaceFrom" placeholder="المساحة من ">
                    </div>
                    <br />
                    <div class="form-group">
                        <label class="preLabel" for="spaceTo"> المساحة إلي :  </label>
                        <input type="number" class="form-control" id="spaceTo" placeholder="  المساحة إلي">
                    </div>
                </div> <!-- End of column -->
                @*<div class="col">

                        <div class="form-group">
                            <label class="preLabel" for="priceFrom">  السعر من : </label>
                            <input type="number" class="form-control" id="priceFrom" placeholder=" السعر من">
                        </div>
                        <br />
                        <div class="form-group">
                            <label class="preLabel" for="priceTo">  السعر إلي :   </label>
                            <input type="number" class="form-control" id="priceTo" placeholder="  السعر إلي">
                        </div>


                    </div>*@ <!-- End of column -->
                <div class="col">

                    <div class="form-group">
                        <label class="preLabel" for="dateFrom">  التاريخ من :  </label>
                        <input type="date" class="form-control" id="dateFrom" placeholder=" التاريخ من ">
                    </div>
                    <br />
                    <div class="form-group">
                        <label class="preLabel" for="dateTo"> التاريخ إلي :  </label>
                        <input type="date" class="form-control" id="dateTo" placeholder="  التاريخ إلي ">
                    </div>
                </div> <!-- End of column -->

            </div> <!-- End of Row -->
            <br />
            <div id="hiddenDivForInstallment">
                <div class="row" id="colPrice">
                    <div class="col-md-3">
                        <h4 class="text-right">طريقة الدفع</h4>
                        @Html.DropDownList("Payments", Model.Payments as SelectList, "All", new { @class = "form-control", })
                        <div id="Moo">
                            <h4 class="text-right">نظام الأقساط</h4>
                            <select id="BasisOfInstallmentDropdown" class="form-control">
                                <option value="0"> اختر نظام القسط </option>
                                <option value="1">سنوي</option>
                                <option value="2">نصف سنوي</option>
                                <option value="3">ربع سنوي</option>
                                <option value="4">شهري</option>
                            </select>
                        </div>

                    </div>
                    <div class="col">
                        <h4 class="text-right" id="priceLableFrom">السعـــر من</h4>
                        <input type="number" placeholder="All" id="priceFrom" class="form-control" />
                        <h4 class="text-right" id="priceLableTo">السعـــر إلى</h4>
                        <input type="number" placeholder="All" id="priceTo" class="form-control" />

                    </div>

                    <div class="col">
                        <h4 class="text-right">المتبقي من</h4>
                        <input type="number" placeholder="All" id="RemainingFrom" class="form-control" />
                        <h4 class="text-right">المتبقي إلى</h4>
                        <input type="number" placeholder="All" id="RemainingTo" class="form-control" />
                    </div>
                    <div class="col">
                        <h4 class="text-right">عدد السنوات من</h4>
                        <input type="number" placeholder="All" id="YearOfInstallmentFrom" class="form-control" />
                        <h4 class="text-right">عدد السنوات إلى</h4>
                        <input type="number" placeholder="All" id="YearOfInstallmentTo" class="form-control" />
                    </div>
                    <div class="col">
                        <h4 class="text-right">المكسب من</h4>
                        <input type="number" placeholder="All" id="OverFrom" class="form-control" />
                        <h4 class="text-right">المكسب إلى</h4>
                        <input type="number" placeholder="All" id="OverTo" class="form-control" />
                    </div>

                </div>
                <div class="row">
                    <div class="col">
                        <h4 class="text-right">فيلا </h4>
                        <input type="number" placeholder="All" id="VillaNumber" class="form-control" />

                    </div>
                    <div class="col">
                        <h4 class="text-right">مجموعه </h4>
                        <input type="number" placeholder="All" id="GroupNumber" class="form-control" />
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <h4 class="text-right">رقم العرض </h4>
                        <input type="number" placeholder="All" id="Available" class="form-control" />
                    </div>   
                </div>
            </div>
        </div>
    </div> <!-- End of container-->
    <div class=" text-center mt-auto">
        <button class="btn btn-default " id="search_btn"> بحث </button> <button type="button" class="btn btn-default" id="morefiltering">عرض عناصر أكثر</button>

        <h3 class="mt-3"> اختر التاريخ و منطقة البحث</h3>
    </div>
    <div class="container-fluid">
        <table class="table text-right table-hover " id="data-table">
            <thead>
                <tr>
                    <th class="text-center">#</th>
                    <th>المنطقة</th>
                    <th>المساحة</th>
                    <th>السعر</th>
                    <th>عدد الغرف</th>
                    <th>عدد الحمامات</th>
                    <th>التشطيب</th>
                    @{
                        if (user.IsAdmin)
                        {
                            <th>حذف</th>
                        }
                    }
                    @*<th>حذف</th>*@
                    <th>المزيد</th>
                </tr>
            </thead>

        </table>

    </div>
    <!--****************************start of Modal************************************************************************************-->
    <div class="modal fade" id="modalContactForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header text-center">
                    <h4 class="modal-title w-100 font-weight-bold">إطلب الشقه</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body mx-3">
                    <div class="md-form mb-1">
                        <label data-error="wrong" data-success="right" for="form34">الإسم الكامل </label>
                        <input type="text" id="ClientName" class="form-control validate">

                    </div>

                    <div class="md-form mb-1">
                        <label data-error="wrong" data-success="right" for="form29">رقم الهاتف المحمول الأول </label>
                        @*<input type="number" id="ClientFirstMobile" class="form-control validate">*@<br />
                        <input type="tel" class="form-control validate" id="clientMobile" placeholder="الموبايل" name="Mobile" />
                        <span class="error-msg error-msg-style"></span><span class="valid-msg valid-msg-style"></span>
                    </div>



                    <div class="md-form mb-1">
                        <label data-error="wrong" data-success="right" for="form29"> رقم الهاتف المحمول الثاني (إختياري )</label>
                        @*<input type="number" id="ClientSecundMobile" class="form-control validate">*@<br />
                        <input type="tel" class="form-control" id="clientMobile2" placeholder="الموبايل2" name="Mobile2">
                        <span class="error-msg2 error-msg-style"></span><span class="valid-msg2 valid-msg-style"></span>
                    </div>

                    <div class="md-form mb-1">
                        <label data-error="wrong" data-success="right" for="form29">رقم الهاتف المنزلي (إختياري  )</label>
                        @*<input type="number" id="ClientTelephone" class="form-control validate">*@<br />
                        <input type="tel" class="form-control" id="clientPhone" placeholder="التليفون" name="Phone">
                        <span class="error-msg3 error-msg-style"></span><span class="valid-msg3 valid-msg-style"></span>
                    </div>


                </div>
                <div class="modal-footer d-flex justify-content-center">
                    <button id="SendData" class="btn btn-unique">حجز معاينة</button>

                </div>
            </div>
        </div>
    </div>
    <!--*************************************End of Modal******************************************-->
    <!--********************************************End thw new one ***********************************************-->
    <div id="myModal" class="modal fade " role="dialog">
        <div class="modal-dialog .modal-dialog-centered modal-lg" role="document">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">تفاصيل العرض</h4>
                </div>
                <div class="modal-body">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>
@section scripts{
    <script>
        var token = $('input[name="__RequestVerificationToken"]').val();
            $(document).ready(function () {
         $("#hiddenDivForInstallment").hide();
               if ($('#Payments').val() == "") {

                    $("#priceLableFrom").html(" السعــر من");
                    $("#priceLableTo").html(" السعــر إلى");
                    $("#BasisOfInstallmentDropdown").attr('disabled', true);
                    $("#OverFrom").attr('disabled', true);
                    $("#OverTo").attr('disabled', true);
                    $("#RemainingFrom").attr('disabled', true);
                    $("#RemainingTo").attr('disabled', true);
                    $("#YearOfInstallmentFrom").attr('disabled', true);
                    $("#YearOfInstallmentTo").attr('disabled', true);
            }
            
            $("#Payments").on('change', function () {
                if ($('#Payments').val() == 4) {

                    $("#priceLableFrom").html("ما تم دفعه من ");
                    $("#priceLableTo").html("ما تم دفعه إلى ");
                    $("#BasisOfInstallmentDropdown").attr('disabled', false);
                    $("#OverFrom").attr('disabled', false);
                    $("#OverTo").attr('disabled', false);
                    $("#RemainingFrom").attr('disabled', false);
                    $("#RemainingTo").attr('disabled', false);
                    $("#YearOfInstallmentFrom").attr('disabled', false);
                    $("#YearOfInstallmentTo").attr('disabled', false);

                }
                else if ($('#Payments').val() == 3) {

                    $("#priceLableFrom").html(" السعــر من");
                    $("#priceLableTo").html(" السعــر إلى");
                    $("#BasisOfInstallmentDropdown").attr('disabled', true);
                    $("#OverFrom").attr('disabled', true);
                    $("#OverTo").attr('disabled', true);
                    $("#RemainingFrom").attr('disabled', true);
                    $("#RemainingTo").attr('disabled', true);
                    $("#YearOfInstallmentFrom").attr('disabled', true);
                    $("#YearOfInstallmentTo").attr('disabled', true);
                }
                 else if ($('#Payments').val() == "") {

                    $("#priceLableFrom").html(" السعــر من");
                    $("#priceLableTo").html(" السعــر إلى");
                    $("#BasisOfInstallmentDropdown").attr('disabled', true);
                    $("#OverFrom").attr('disabled', true);
                    $("#OverTo").attr('disabled', true);
                    $("#RemainingFrom").attr('disabled', true);
                    $("#RemainingTo").attr('disabled', true);
                    $("#YearOfInstallmentFrom").attr('disabled', true);
                    $("#YearOfInstallmentTo").attr('disabled', true);
                }
            });

            //SET THE DATE TIME PICKER TO TODAY DATE
            var now = new Date();
            var day = ("0" + now.getDate()).slice(-2);
            var month = ("0" + (now.getMonth() + 1)).slice(-2);
            var today = now.getFullYear() + "-" + (month) + "-" + (day);
           // $('.pdate').val(today);
            // END SET DATE
                $("#morefiltering").click(function () {
                $("#hiddenDivForInstallment").toggle(300);
            });
            $("#search_btn").click(function () {
                table.draw();
            });

            function format(full) {
                // `d` is the original data object for the row
                var checkIsAdmine = "@user.IsAdmin";
                if (checkIsAdmine == "True") {
                    return '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;width:100%;">' +
                        '<tr>' +
                        '<td align="right">' + '<button type="button" title="تعديل " rel="tooltip" class="btn btn-success btn-sm btn-icon unitDetails" data-toggle="modal" data-id="' + full.PK_VillasAvailables_Id + '"><i class="tim-icons icon-notes"></i></button>' + '</td>' +
                        //'<td align="right">' + '<button type="button" title="حذف " rel="tooltip" class="btn btn-danger btn-sm btn-icon delete" data-id="' + full.PK_VillasAvailables_Id + '"><i class="tim-icons icon-simple-remove"></i></button>' + '</td>' +
                        '<td align="right">' + '<a  class="filter" href="/VillasAvailable/GetInstantMatches/' + full.PK_VillasAvailables_Id + '">الترشيحات</a>' + '</td>' +
                        //'<td align="right">' + '<a  class=" btn btn-default " href = "/AvailableQuickSearch/DemandAvailable?demandId=' + full.PK_AvailableUnits_Id + '" >بحث عن طلبات عميل معين بالاسم او الهاتف</a>' + '</td>' +
                        '<td align="right">' + '<a  class=" btn btn-default " href = "/VillasAvailableQuicSearch/VillasDemandAvailable?AvailableId=' + full.PK_VillasAvailables_Id + '&selerId=' + full.FK_VillasAvailables_Clients_ClientId + '" >بحث عن طلبات عميل معين بالاسم او الهاتف</a>' + '</td>' +
                        '<td align="right">' + '<a id="newPreview" class=" btn btn-default "data-toggle="modal" data-target="#modalContactForm" data-id="' + full.PK_VillasAvailables_Id + '">عمل معاينه لعميل جديد</a>' + '</td>' +
                        '</tr>' +
                        '</table>';


                }
                else {
                    return '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;width:100%;">' +
                        '<tr>' +
                        '<td align="right">' + '<button type="button" title="تعديل " rel="tooltip" class="btn btn-success btn-sm btn-icon unitDetails" data-toggle="modal" data-id="' + full.PK_VillasAvailables_Id + '"><i class="tim-icons icon-notes"></i></button>' + '</td>' +
                        '<td align="right">' + '<a  class="filter" href="/VillasAvailable/GetInstantMatches/' + full.PK_VillasAvailables_Id + '">الترشيحات</a>' + '</td>' +
                        //'<td align="right">' + '<a  class=" btn btn-default " href = "/AvailableQuickSearch/DemandAvailable?demandId=' + full.PK_AvailableUnits_Id + '" >بحث عن طلبات عميل معين بالاسم او الهاتف</a>' + '</td>' +
                        '<td align="right">' + '<a  class=" btn btn-default " href = "/VillasAvailableQuicSearch/VillasDemandAvailable?AvailableId=' + full.PK_VillasAvailables_Id + '&selerId=' + full.FK_VillasAvailables_Clients_ClientId + '" >بحث عن طلبات عميل معين بالاسم او الهاتف</a>' + '</td>' +
                        '<td align="right">' + '<a id="newPreview" class=" btn btn-default "data-toggle="modal" data-target="#modalContactForm" data-id="' + full.PK_VillasAvailables_Id + '">عمل معاينه لعميل جديد</a>' + '</td>' +
                        '</tr>' +
                        '</table>';
                }




            }
                var checkIsAdmine = "@user.IsAdmin";
                if (checkIsAdmine == "True") {
                    table = $("table").DataTable({

                        "language": {
                            "url": "/Theme/assets/Plugins/DataTables/arabic.lang.json"
                        },
                        "processing": true,
                        "serverSide": true,
                        "filter": false,
                        "bFilter": false,
                        "orderMulti": false,
                        "pageLength": 5,
                        "ajax": {
                            "url": "/VillasAvailableQuicSearch/LoadData",
                            "type": "post",
                            "datatype": "json",
                            "data": function (d) {
                        @*#areaFrom #areaTo #spaceFrom #spaceTo #priceFrom #priceTo #dateFrom #dateTo #search_btn  #data-table   *@
                                d.regionFrom = $("#regionss").val();
                                d.regionTo = $("#regionssTo").val();
                                d.fromDate = $("#dateFrom").val();
                                d.toDate = $("#dateTo").val();
                                d.SpaceFrom = $("#spaceFrom").val();
                                d.SpaceTo = $("#spaceTo").val();
                                d.PriceFrom = $("#priceFrom").val();
                                d.PriceTo = $("#priceTo").val();
                                //new feild
                            d.Payments = $("#Payments").val();
                            d.BasisOfInstallmentDropdown = $("#BasisOfInstallmentDropdown").val();
                            d.OverFrom = $("#OverFrom").val();
                            d.OverTo = $("#OverTo").val();
                            d.RemainingFrom = $("#RemainingFrom").val();
                            d.RemainingTo = $("#RemainingTo").val();
                            d.YearOfInstallmentFrom = $("#YearOfInstallmentFrom").val();
                            d.YearOfInstallmentTo = $("#YearOfInstallmentTo").val();
                            d.VillaNumber = $("#VillaNumber").val();
                                d.GroupNumber = $("#GroupNumber").val();
                                d.Available = $("#Available").val();
                            },
                        },
                        "columns":
                            [

                                { "data": "PK_VillasAvailables_Id", "name": "PK_VillasAvailables_Id", "autoWidth": true },
                                { "data": "RegionName", "name": "RegionName", "autowidth": true },
                                { "data": "Space", "name": "Space", "autowidth": true },
                                { "data": "Price", "name": "Price", "autowidth": true },
                                { "data": "Rooms", "name": "Rooms", "autowidth": true },
                                { "data": "BathRooms", "name": "BathRooms", "autowidth": true },
                                { "data": "Type", "name": "Type", "autowidth": true },
                        @*{
                            "render": function (data, type, full, meta) { return ' <button type="button" title="تعديل " rel="tooltip" class="btn btn-success btn-sm btn-icon unitDetails" data-toggle="modal" data-id="' + full.PK_AvailableUnits_Id + '"><i class="tim-icons icon-notes"></i></button>'; }
                        },*@
                                {
                                    "render": function (data, type, full, meta) {
                                        var checkIsAdmine = "@user.IsAdmin";
                                        if (checkIsAdmine == "True") {
                                            return '<button type="button" title="حذف " rel="tooltip" class="btn btn-danger btn-sm btn-icon delete" data-id="' + full.PK_VillasAvailables_Id + '"><i class="tim-icons icon-simple-remove"></i></button>';
                                        }
                                        else { return '' }
                                    }

                                },
                                {

                                    "className": 'details-control',
                                    "orderable": false,
                                    "data": null,
                                    "defaultContent": ''

                                },
                            ],

                    });
                }
                else {
                    table = $("table").DataTable({

                        "language": {
                            "url": "/Theme/assets/Plugins/DataTables/arabic.lang.json"
                        },
                        "processing": true,
                        "serverSide": true,
                        "filter": false,
                        "bFilter": false,
                        "orderMulti": false,
                        "pageLength": 5,
                        "ajax": {
                            "url": "/VillasAvailableQuicSearch/LoadData",
                            "type": "post",
                            "datatype": "json",
                            "data": function (d) {
                        @*#areaFrom #areaTo #spaceFrom #spaceTo #priceFrom #priceTo #dateFrom #dateTo #search_btn  #data-table   *@
                                d.regionFrom = $("#regionss").val();
                                d.regionTo = $("#regionssTo").val();
                                d.fromDate = $("#dateFrom").val();
                                d.toDate = $("#dateTo").val();
                                d.SpaceFrom = $("#spaceFrom").val();
                                d.SpaceTo = $("#spaceTo").val();
                                d.PriceFrom = $("#priceFrom").val();
                                d.PriceTo = $("#priceTo").val();
                                //new feild
                            d.Payments = $("#Payments").val();
                            d.BasisOfInstallmentDropdown = $("#BasisOfInstallmentDropdown").val();
                            d.OverFrom = $("#OverFrom").val();
                            d.OverTo = $("#OverTo").val();
                            d.RemainingFrom = $("#RemainingFrom").val();
                            d.RemainingTo = $("#RemainingTo").val();
                            d.YearOfInstallmentFrom = $("#YearOfInstallmentFrom").val();
                            d.YearOfInstallmentTo = $("#YearOfInstallmentTo").val();
                            d.VillaNumber = $("#VillaNumber").val();
                                d.GroupNumber = $("#GroupNumber").val();
                                d.Available = $("#Available").val();
                            },
                        },
                        "columns":
                            [

                                { "data": "PK_VillasAvailables_Id", "name": "PK_VillasAvailables_Id", "autoWidth": true },
                                { "data": "RegionName", "name": "RegionName", "autowidth": true },
                                { "data": "Space", "name": "Space", "autowidth": true },
                                { "data": "FloorNumber", "name": "FloorNumber", "autowidth": true },
                                { "data": "Price", "name": "Price", "autowidth": true },
                                { "data": "Rooms", "name": "Rooms", "autowidth": true },
                                { "data": "BathRooms", "name": "BathRooms", "autowidth": true },
                                { "data": "Type", "name": "Type", "autowidth": true },
                        @*{
                            "render": function (data, type, full, meta) { return ' <button type="button" title="تعديل " rel="tooltip" class="btn btn-success btn-sm btn-icon unitDetails" data-toggle="modal" data-id="' + full.PK_AvailableUnits_Id + '"><i class="tim-icons icon-notes"></i></button>'; }
                        },*@

                                {

                                    "className": 'details-control',
                                    "orderable": false,
                                    "data": null,
                                    "defaultContent": ''

                                },
                            ],

                    });
                }
            //add Child rows here ****************************************************
            $('table tbody').on('click', 'td.details-control', function () {
                var tr = $(this).closest('tr');
                var row = table.row(tr);

                if (row.child.isShown()) {
                    // This row is already open - close it
                    row.child.hide();
                    tr.removeClass('shown');
                }
                else {
                    // Open this row
                    
                    row.child(format(row.data())).show();
                    tr.addClass('shown');
                }
            });


             $("table").on("click", ".delete", function () {

                var Id = $(this).attr("data-id");
                var button = $(this);
                alertify.confirm(
                     "هل تريد حذف هذا العرض؟", function (confirm) {
                         if (confirm) {
                             $.ajax({
                                 url: "/VillasAvailable/DeleteClientSale",
                                 type: "post",
                                 data: {
                                     __RequestVerificationToken: token,
                                     id: Id,
                                 },

                                 success: function (result) {
                                     if (result.valid) {
                                         alertify.alert(result.message, function () {
                                             button.parents("tr").remove();
                                         });
                                     }
                                     else {
                                         alertify.alert(result.message, function () { });
                                     }

                                 }
                             })
                         }

                     }

                )
            })
                  //*****************************************************************************start send Api data *********************************
             function getDate() {
               var today = new Date();
               var date = today.getFullYear()+'/'+(today.getMonth()+1)+'/'+today.getDate();
               var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
                var dateTime = date + ' ' + time;
                return dateTime;
            }
        $("#SendData").click(function (e) {
                debugger;
                var postModel = {
                        Name: $("#ClientName").val(),
                        Mobile:$("#clientMobile").val(),
                        Mobile2:$("#clientMobile2").val(),
                        Phone: $("#clientPhone").val(),
                        ContactHour: $("#BestTime").val(),
                        Notes: $("#nots").val(),
                        Unit_Id: $("#newPreview").attr("data-id"),
                        FK_Posts_Categories_Id: 3,
                        IsClosed: false,
                        CraetedAt: getDate(),
                    }
                $.ajax({
                    type: "POST",
                    url: "/VillasAvailableQuicSearch/SetPreview/",
                    //crossDomain: true,
                    //async: false,
                    //dataType: "Application/json",
                    accepts: "Application/json",
                    data: postModel,
                    success: function (response) {

                           if (response.valid) {
                            alertify.alert(response.message, function () {
                                     location.href = "/VillasAvailable/DemandMatchesAfterAdd/";                    
                            });
                        }
                        else {
                            alertify.alert(response.message, function () {

                            });
                        };

                    }
                    , error: function () {

                            alertify.alert("حدث خطأ أثناء حفظ البيانات الرجاء المحاوله مره أخرى");
                    }
                });

        });
            //*****************************************************************************end send Api data *********************************
            $(document).on("click", ".unitDetails", function () {
                var availableId = $(this).attr("data-id");
                location.href = "/VillasAvailable/EditClientSale/" + availableId;
            });
        });
    </script>
}



